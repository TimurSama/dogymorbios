@tailwind base;
@tailwind components;
@tailwind utilities;

/* Дизайн-токены Dogymorbis */

:root {
  /* Light Theme */
  --background: #FFFFFF;
  --surface: #FAF8F5;
  --surface-2: #F0ECE7;
  --text-primary: #1C1A19;
  --text-secondary: #58524D;
  --line: #D9D3CC;
  --outline: #B8AEA5;
  
  /* Accents - пастельные тона */
  --sky: #AFCBFF;
  --honey: #E8DCA8;
  --burgundy: #A95056;
  --chocolate: #6B4B3E;
  --success: #86C8BC;
  --warning: #E1A177;
  --danger: #E57C73;
  --info: #7FA7D9;
  
  /* Дополнительные пастельные акценты */
  --pastel-pink: #FFB3BA;
  --pastel-lavender: #BAE1FF;
  --pastel-mint: #BAFFC9;
  --pastel-peach: #FFDFBA;
  --pastel-lilac: #E6D5FF;
  --pastel-rose: #FFD1DC;
  
  /* State Layer */
  --state-hover: rgba(0, 0, 0, 0.04);
  --state-pressed: rgba(0, 0, 0, 0.08);
  --state-focus: rgba(175, 203, 255, 0.12);
}

.dark {
  /* Dark Theme */
  --background: #2C2B29;
  --surface: #1F1E1C;
  --surface-2: #3A3634;
  --text-primary: #F5F4F2;
  --text-secondary: #CFCAC5;
  --line: #4A4542;
  --outline: #665E58;
  
  /* State Layer Dark */
  --state-hover: rgba(255, 255, 255, 0.04);
  --state-pressed: rgba(255, 255, 255, 0.08);
  --state-focus: rgba(175, 203, 255, 0.12);
}

/* Микрошум текстура */
body {
  background-color: var(--background);
  color: var(--text-primary);
  font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 
    'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='3.5' numOctaves='1' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.02'/%3E%3C/svg%3E");
  background-attachment: fixed;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Плавная анимация для всех переходов - оптимизация производительности */
* {
  transition-property: background-color, border-color, color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
  /* Оптимизация для GPU */
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Оптимизация анимаций для слабых устройств */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Оптимизация для устройств с низкой производительностью */
@media (prefers-reduced-motion: no-preference) {
  .will-change-transform {
    will-change: transform;
  }
  
  .will-change-opacity {
    will-change: opacity;
  }
  
  .will-change-scroll {
    will-change: scroll-position;
  }
}

/* Базовые стили */
@layer base {
  html {
    @apply antialiased;
  }
  
  h1 {
    @apply text-display font-bold;
  }
  
  h2 {
    @apply text-title font-semibold;
  }
  
  h3 {
    @apply text-label font-semibold;
  }
  
  p {
    @apply text-body;
  }
  
  small {
    @apply text-caption;
  }
}

/* Компонентные утилиты */
@layer components {
  /* State Layer - для интерактивных элементов */
  .state-layer {
    @apply relative overflow-hidden;
  }
  
  .state-layer::before {
    content: '';
    @apply absolute inset-0 opacity-0 transition-opacity duration-150 pointer-events-none;
    background-color: var(--state-hover);
  }
  
  .state-layer:hover::before {
    @apply opacity-100;
  }
  
  .state-layer:active::before {
    background-color: var(--state-pressed);
    @apply opacity-100;
  }
  
  .state-layer:focus-visible::before {
    background-color: var(--state-focus);
    @apply opacity-100;
  }
  
  /* Elevation тени - мягкие и пастельные */
  .elevation-0 {
    box-shadow: 0 0 0 1px var(--outline);
  }
  
  .elevation-1 {
    box-shadow: 0 2px 4px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04), 0 0 0 1px var(--outline);
  }
  
  .elevation-2 {
    box-shadow: 0 4px 8px rgba(0,0,0,.08), 0 2px 4px rgba(0,0,0,.06), 0 0 0 1px var(--outline);
  }
  
  .elevation-3 {
    box-shadow: 0 8px 16px rgba(0,0,0,.10), 0 4px 8px rgba(0,0,0,.08), 0 0 0 1px var(--outline);
  }
  
  /* Мягкие тени для кнопок */
  .shadow-soft {
    box-shadow: 0 2px 8px rgba(0,0,0,.08), 0 1px 3px rgba(0,0,0,.06);
  }
  
  .shadow-soft-lg {
    box-shadow: 0 4px 16px rgba(0,0,0,.10), 0 2px 6px rgba(0,0,0,.08);
  }
  
  /* Анимация появления - оптимизированная */
  .fade-in {
    animation: fadeIn 0.3s ease-out;
    will-change: opacity;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  .slide-up {
    animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    will-change: transform, opacity;
  }
  
  @keyframes slideUp {
    from {
      transform: translate3d(0, 20px, 0);
      opacity: 0;
    }
    to {
      transform: translate3d(0, 0, 0);
      opacity: 1;
    }
  }
  
  /* Оптимизация для мобильных устройств */
  @media (max-width: 768px) {
    /* Уменьшаем сложность анимаций на мобильных */
    .fade-in,
    .slide-up {
      animation-duration: 0.2s;
    }
  }
  
  /* Скроллбар */
  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-track {
    background: var(--surface);
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--outline);
    border-radius: 4px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
  }
  
  /* Скрытие scrollbar на мобильных */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

/* Утилиты */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
  
  .blur-backdrop {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
  
  /* Gradient для акцентов */
  .gradient-sky {
    background: linear-gradient(135deg, var(--sky) 0%, var(--info) 100%);
  }
  
  .gradient-honey {
    background: linear-gradient(135deg, var(--honey) 0%, var(--warning) 100%);
  }
  
  /* Tap animation компрессия - мягкая */
  .tap-compress {
    transform: scale(1);
    transition: transform 150ms cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  .tap-compress:active {
    transform: scale(0.97);
  }
  
  /* Spring анимация для кнопок */
  .spring-button {
    transition: all 200ms cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  .spring-button:hover {
    transform: translateY(-1px);
  }
  
  .spring-button:active {
    transform: translateY(0) scale(0.98);
  }
  
  /* Мобильные touch-зоны (минимум 44x44px) */
  @media (max-width: 768px) {
    .touch-target {
      min-width: 44px;
      min-height: 44px;
    }
  }
}

/* Кастомные лоадеры */
@keyframes rolling-ball {
  0% {
    transform: rotate(0deg) translateX(0);
  }
  100% {
    transform: rotate(360deg) translateX(2px);
  }
}

@keyframes paw-trail {
  0%, 100% {
    opacity: 0;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes medallion-swing {
  0%, 100% {
    transform: rotate(0deg);
  }
  25% {
    transform: rotate(15deg);
  }
  75% {
    transform: rotate(-15deg);
  }
}

/* PWA стили */
@media (display-mode: standalone) {
  body {
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
  }
}

/* Адаптивность - Mobile First */
@media (max-width: 768px) {
  body {
    font-size: 14px;
  }
  
  h1 {
    @apply text-title;
  }
  
  /* Увеличенные touch-зоны для мобильных */
  button, a, input, select, textarea {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Оптимизация для одной руки */
  .bottom-nav {
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* Safe area для устройств с вырезом */
.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

.safe-area-top {
  padding-top: env(safe-area-inset-top);
}

.safe-area-left {
  padding-left: env(safe-area-inset-left);
}

.safe-area-right {
  padding-right: env(safe-area-inset-right);
}

/* Печать */
@media print {
  body {
    background: white;
    color: black;
  }
  
  .no-print {
    display: none !important;
  }
}


